{"version":3,"file":"js/378.91d243e9.js","mappings":"glCAMA,MAAMA,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,S,giBCYM,KAAEC,IAASC,EAAAA,EAAAA,IAAOC,IAGlB,YAAEC,KADaC,EAAAA,EAAAA,MACGC,EAAAA,EAAAA,M,y6CCjBxB,MAAMN,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,S,8YCDMO,GAAaC,EAAAA,EAAAA,KACbC,GAAeJ,EAAAA,EAAAA,MAMf,KAAEK,IAASR,EAAAA,EAAAA,IAAOC,GACxBQ,EAAQC,IAAIF,EAAKG,OACjB,MAAMC,GAAOC,EAAAA,EAAAA,IAAS,CACpBC,EAAG,EACHC,EAAG,EACHC,OAAO,EACPC,YAAa,uBAGfC,EAAAA,EAAAA,KAAc,KACZN,EAAKE,GAAIK,EAAAA,EAAAA,IAAMX,EAAKG,MAAMS,IAAIN,EAC9BF,EAAKG,GAAII,EAAAA,EAAAA,IAAMX,EAAKG,MAAMS,IAAIL,KAEhC,MAAMM,EAAYC,UAChB,IAAIV,EAAKI,MAAT,CAGAJ,EAAKK,YAAc,oBACnBL,EAAKI,OAAQ,EACb,UACoBX,EAAWkB,aAC1BC,QAAQnB,EAAWoB,cAAeC,EAAAA,IAClCC,KAAK,CAAEC,KAAMrB,EAAasB,UAC7BxB,EAAWyB,mBACXlB,EAAKI,OAAQ,EACbJ,EAAKK,YAAc,oBACnB,MAAOc,GACPnB,EAAKI,OAAQ,EACbJ,EAAKK,YAAc,oBACnBe,OAAOC,QAAQF,EAAMG,Y,ypBCrCzB,MAAMpC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,Q,weCIA,MAAMqC,GAAQC,EAAAA,EAAAA,MACRC,GAASC,EAAAA,EAAAA,MACT/B,GAAeJ,EAAAA,EAAAA,KACfE,GAAaC,EAAAA,EAAAA,MACb,EAAEiC,IAAMC,EAAAA,EAAAA,MACRhC,EAAO2B,EAAMM,MAEnB,IAAIC,GAAUC,EAAAA,EAAAA,IAAI,GAClB,MAAM/B,GAAOC,EAAAA,EAAAA,IAAS,CACpB+B,KAAM,GACNC,WAAW,EACXC,QAAQ,EACRC,SAAS,EACThD,KAAM,GACNiD,SAAS,EACTC,UAAU,EACVC,KAAM,EACNC,MAAM,EACNnC,OAAO,EACPC,YAAa,oBACbmC,MAAO,EACPC,SAAU,KAENC,EAAU,CACd,CACEC,MAAOhB,EAAE,SACTiB,OAAOC,GACL,OAAOC,QAAOC,EAAAA,EAAAA,IAAYF,EAAIG,QAAQC,QAAQ,KAGlD,CACEN,MAAOhB,EAAE,mBACTuB,IAAK,SAKP,CACEP,MAAOhB,EAAE,mBACTiB,OAAOC,GACL,OAAOM,EAAAA,EAAAA,IAAYN,EAAIO,aAIvBC,EAAgB3C,UACpB,MAAM4C,QAAY3D,EAAa4D,WAAWC,SAAS5D,EAAK6D,SAASC,OACjE5B,EAAQ/B,MAAQuD,EAAIK,MACpB9D,EAAQC,IAAIwD,IAERM,EAAgB,MACpBC,EAAAA,EAAAA,IAAejE,EAAK6D,QAASzD,EAAKsC,KAAO,GAAGwB,MAAMR,IAChDtD,EAAKgC,KAAOsB,EAAItD,KAAK+D,QACrB/D,EAAKwC,MAAQc,EAAItD,KAAKgE,UAGpBC,EAAcvD,gBACZjB,EAAWyE,kBACjB,MAAMZ,QAAY7D,EAAWkB,aAC1BwD,UAAUxE,EAAasB,SACvByC,OACH1D,EAAKyC,UAAWM,EAAAA,EAAAA,IAAYO,EAAM,MAEpChD,EAAAA,EAAAA,KAAc,KACZ+C,IACAO,QAEFQ,EAAAA,EAAAA,KAAY,KACNzE,EAAasB,SACfgD,OAIJ,MAAMI,EAAQ3D,WACPV,EAAKyC,WAAYM,EAAAA,EAAAA,IAAYnD,EAAKoD,OACrC5B,OAAOkD,SAASC,QAAQ5C,EAAE,YAGxB/B,EAAK4E,QAAU7E,EAAasB,SAIhCjB,EAAKiC,WAAY,EACjBjC,EAAKkC,QAAS,EACdlC,EAAKmC,SAAU,GALbf,OAAOkD,SAASnD,MAAMQ,EAAE,kBAOtB8C,EAAQ/D,UACZ,IAAIV,EAAKI,MAAT,CAGAJ,EAAKI,OAAQ,EACb,IACE,MAAMkD,QAAY3D,EAAa+E,cAC5BC,IAAI/E,EAAKY,IACTO,KAAK,CAAEC,KAAMrB,EAAasB,UAC7BjB,EAAKkC,QAAS,EACdlC,EAAKmC,SAAU,EACfnC,EAAKI,OAAQ,EACbJ,EAAKb,KAAOmE,EAAIsB,gBAChBjF,EAAakF,QAAQ7E,EAAKb,KAAM,GAChC,MAAOgC,GACPnB,EAAKkC,QAAS,EACdlC,EAAKmC,SAAU,EACfnC,EAAKI,OAAQ,EACbJ,EAAKb,KAAOgC,EAAMG,WAGhBb,EAAYC,UAChB,IAAIV,EAAKI,MAAT,CAGAJ,EAAKK,YAAc,oBACnBL,EAAKI,OAAQ,EACb,UACoBX,EAAWkB,aAC1BC,QAAQnB,EAAWoB,cAAeC,EAAAA,IAClCC,KAAK,CAAEC,KAAMrB,EAAasB,UAC7BxB,EAAWyB,mBACXlB,EAAKI,OAAQ,EACbJ,EAAKK,YAAc,oBACnB,MAAOc,GACPnB,EAAKI,OAAQ,EACbJ,EAAKK,YAAc,oBACnBe,OAAOC,QAAQF,EAAMG,YAGnBwD,EAAU,KACd9E,EAAKiC,WAAY,EACbjC,EAAKmC,SACP4C,YAAW,KACTtD,EAAOuD,IAAI,KACV,M,41CCxIP,MAAM,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE","sources":["webpack://node-demo/./src/components/pixelInfo.vue","webpack://node-demo/./src/components/swapAlert.vue","webpack://node-demo/./src/components/swapAlert.vue?6f3c","webpack://node-demo/./src/views/Market/components/buyInfo.vue","webpack://node-demo/./src/views/Market/components/buyInfo.vue?a72b","webpack://node-demo/./src/views/Market/details.vue","webpack://node-demo/./src/views/Market/details.vue?8bf4"],"sourcesContent":["import script from \"./pixelInfo.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./pixelInfo.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./pixelInfo.vue?vue&type=style&index=0&id=0735de9e&lang=scss&scoped=true\"\n\nimport exportComponent from \"/Users/zhuweiyun/Desktop/zwy/vue3-pc-天空之城/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0735de9e\"]])\n\nexport default __exports__","<script setup>\nimport { ref, reactive, toRefs } from 'vue';\nimport popupTitle from '@/components/popupTitle.vue';\nimport { commonStore } from '@/store/common';\nimport useClipboard from 'vue-clipboard3';\nimport loadingIcon from './loadingIcon.vue';\n\nconst props = defineProps({\n  finish: Boolean,\n  success: Boolean,\n  hash: String,\n  type: String,\n  text: String,\n  title: String,\n  btn: String,\n  empowerText: String,\n  empower: Boolean,\n  check: Boolean,\n});\n\nconst { hash } = toRefs(props);\nconst emit = defineEmits(['closeFn', 'empowerFn', 'submit']);\nconst common_store = commonStore();\nconst { toClipboard } = useClipboard();\n</script>\n<template>\n  <div class=\"bind allFlex column\">\n    <span\n      class=\"success-btn Wcolor font-Two\"\n      :class=\"[success ? 'btnBg' : 'redBg']\"\n      v-show=\"finish\"\n      >{{ success ? $t('success') : $t('fail') }}</span\n    >\n    <loading-icon class=\"loading\" v-show=\"!finish && check\"></loading-icon>\n    <p class=\"popup-title Wcolor font-Eight font500 center\">\n      {{ $t(title) }}\n    </p>\n    <div class=\"bind_ipt center Wcolor\" v-if=\"!finish\">\n      <slot></slot>\n    </div>\n\n    <div\n      class=\"bind_ipt bgPadding center\"\n      :class=\"[success ? 'mainColor font-Ty' : 'redColor hashFont font-Four']\"\n      v-if=\"finish\"\n    >\n      {{ success ? $t(text) : hash }}\n    </div>\n    <div class=\"bgPadding\">\n      <n-button\n        type=\"tertiary\"\n        v-if=\"!empower\"\n        :disabled=\"check\"\n        class=\"font-Three btn\"\n        block\n        @click=\"$emit('empowerFn')\"\n        >{{ $t(empowerText) }}</n-button\n      >\n      <n-button\n        class=\"btn font-Three\"\n        type=\"primary\"\n        :disabled=\"!empower || check\"\n        @click=\"$emit('submit')\"\n        v-show=\"!finish\"\n        block\n        >{{ $t(btn) }}</n-button\n      >\n      <n-button\n        class=\"btn font-Three\"\n        :type=\"success ? 'primary' : 'error'\"\n        v-show=\"finish\"\n        block\n        @click=\"$emit('closeFn')\"\n        >{{ $t('SwapAlert.close') }}</n-button\n      >\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.popup-title {\n  position: relative;\n  height: 50px;\n  line-height: 50px;\n}\n.bind {\n  width: 378px;\n  height: 250px;\n  background: url('../assets/commonImg/alert-bg1.png') no-repeat;\n  background-size: 100% 100%;\n  position: relative;\n  padding: 4px 10px 30px 10px;\n  &_ipt {\n    text-overflow: ellipsis;\n    word-break: break-all;\n    padding: 15px;\n    line-height: 30px;\n    max-height: 120px;\n    overflow-y: scroll;\n  }\n}\n.loading {\n  position: absolute;\n  top: 15px;\n  right: 15px;\n}\n.success-btn {\n  padding: 2px 6px;\n  border-radius: 4px;\n  transform: scale(0.8);\n  position: absolute;\n  top: 15px;\n  right: 10px;\n}\n.btn {\n  text-align: center;\n  margin-top: 10px;\n}\n</style>\n","import script from \"./swapAlert.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./swapAlert.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./swapAlert.vue?vue&type=style&index=0&id=65675c50&lang=scss&scoped=true\"\n\nimport exportComponent from \"/Users/zhuweiyun/Desktop/zwy/vue3-pc-天空之城/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-65675c50\"]])\n\nexport default __exports__","<script setup>\nimport { ref, reactive, toRefs, onBeforeMount } from 'vue';\nimport { swapStore } from '@/store/swap';\nimport pixelInfo from '@/components/pixelInfo.vue';\nimport { MaxUint256 } from '@ethersproject/constants';\nimport { commonStore } from '@/store/common';\nimport { getXY } from '@/utils';\nconst swap_store = swapStore();\nconst common_store = commonStore();\nconst props = defineProps({\n  info: Object,\n  colorId: Number,\n});\ndefineEmits(['buy']);\nconst { info } = toRefs(props);\nconsole.log(info.value);\nconst data = reactive({\n  x: 0,\n  y: 0,\n  check: false,\n  empowerText: 'EmpowerAlert.btn4',\n});\n\nonBeforeMount(() => {\n  data.x = getXY(info.value.id).x;\n  data.y = getXY(info.value.id).y;\n});\nconst empowerFn = async () => {\n  if (data.check) {\n    return;\n  }\n  data.empowerText = 'EmpowerAlert.btn1';\n  data.check = true;\n  try {\n    const res = await swap_store.tokenMethods\n      .approve(swap_store.marketSpender, MaxUint256)\n      .send({ from: common_store.address });\n    swap_store.setMarketEmpower();\n    data.check = false;\n    data.empowerText = 'EmpowerAlert.btn4';\n  } catch (error) {\n    data.check = false;\n    data.empowerText = 'EmpowerAlert.btn4';\n    window.$messag(error.message);\n  }\n};\n</script>\n<template>\n  <ul class=\"buy-info bg\">\n    <li class=\"titleBg padding allFlex li_info\">\n      <pixel-info\n        :x=\"data.x\"\n        :y=\"data.y\"\n        :price=\"info.price\"\n        :colorId=\"colorId\"\n      ></pixel-info>\n    </li>\n    <li class=\"li_btn\">\n      <div class=\"btn\" v-if=\"!swap_store.marketEmpower\">\n        <n-button\n          type=\"default\"\n          block\n          @click=\"empowerFn\"\n          :disabled=\"data.check\"\n          >{{\n            data.check ? $t('EmpowerAlert.btn1') : $t('EmpowerAlert.btn4')\n          }}</n-button\n        >\n      </div>\n      <div class=\"\">\n        <n-button type=\"primary\" block @click=\"$emit('buy')\">{{\n          $t('buy')\n        }}</n-button>\n      </div>\n    </li>\n  </ul>\n</template>\n\n<style lang=\"scss\" scoped>\n.buy-info {\n  border-radius: 12px;\n  overflow: hidden;\n  margin: 30px 0 0;\n  box-sizing: border-box;\n  .li_btn {\n    margin-top: 15px;\n    padding: 35px 100px;\n  }\n  .btn {\n    margin-bottom: 20px;\n  }\n  .li_info {\n    height: 70px;\n    padding: 0 30px;\n  }\n}\n</style>\n","import script from \"./buyInfo.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./buyInfo.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./buyInfo.vue?vue&type=style&index=0&id=325e2150&lang=scss&scoped=true\"\n\nimport exportComponent from \"/Users/zhuweiyun/Desktop/zwy/vue3-pc-天空之城/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-325e2150\"]])\n\nexport default __exports__","<script setup>\nimport { ref, reactive, onBeforeMount, watchEffect } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport { commonStore } from '@/store/common';\nimport { swapStore } from '@/store/swap';\nimport buyInfo from './components/buyInfo.vue';\nimport swapAlert from '@/components/swapAlert.vue';\nimport { NDataTable, NPagination, NModal } from 'naive-ui';\nimport { getPixelRecord } from '@/http/api';\nimport { MaxUint256 } from '@ethersproject/constants';\nimport { getFullTime, getUrl, balanceUtil } from '@/utils/index.js';\nimport { useI18n } from 'vue-i18n';\nconst route = useRoute();\nconst router = useRouter();\nconst common_store = commonStore();\nconst swap_store = swapStore();\nconst { t } = useI18n();\nconst info = route.query;\nconst navArr = ['price', 'Market.nav.four', 'Market.nav.five'];\nlet colorId = ref(0);\nconst data = reactive({\n  list: [],\n  alertShow: false,\n  finish: false,\n  success: false,\n  hash: '',\n  loading: true,\n  finished: false,\n  page: 1,\n  show: false,\n  check: false,\n  empowerText: 'EmpowerAlert.btn4',\n  total: 0,\n  tokenBal: '',\n});\nconst columns = [\n  {\n    title: t('price'),\n    render(row) {\n      return Number(balanceUtil(row.price)).toFixed(2);\n    },\n  },\n  {\n    title: t('Market.nav.four'),\n    key: 'owner',\n    // render(row) {\n    //   return row.owner.slice(0, 6) + '...' + row.owner.slice(-4);\n    // },\n  },\n  {\n    title: t('Market.nav.five'),\n    render(row) {\n      return getFullTime(row.selltime);\n    },\n  },\n];\nconst getPixelColor = async () => {\n  const res = await common_store.allMethods.getPixel(info.tokenid).call();\n  colorId.value = res.color;\n  console.log(res);\n};\nconst getRecordList = () => {\n  getPixelRecord(info.tokenid, data.page - 1).then((res) => {\n    data.list = res.data.results;\n    data.total = res.data.count;\n  });\n};\nconst getTokenBal = async () => {\n  await swap_store.getTokenMethods();\n  const res = await swap_store.tokenMethods\n    .balanceOf(common_store.address)\n    .call();\n  data.tokenBal = balanceUtil(res + '');\n};\nonBeforeMount(() => {\n  getPixelColor();\n  getRecordList();\n});\nwatchEffect(() => {\n  if (common_store.address) {\n    getTokenBal();\n  }\n});\n\nconst toBuy = async () => {\n  if (+data.tokenBal < +balanceUtil(info.price)) {\n    window.$message.warning(t('skytBal'));\n    return;\n  }\n  if (info.seller == common_store.address) {\n    window.$message.error(t('Market.alert'));\n    return;\n  }\n  data.alertShow = true;\n  data.finish = false;\n  data.success = false;\n};\nconst buyFn = async () => {\n  if (data.check) {\n    return;\n  }\n  data.check = true;\n  try {\n    const res = await common_store.marketMethods\n      .buy(info.id)\n      .send({ from: common_store.address });\n    data.finish = true;\n    data.success = true;\n    data.check = false;\n    data.hash = res.transactionHash;\n    common_store.addHash(data.hash, 0);\n  } catch (error) {\n    data.finish = true;\n    data.success = false;\n    data.check = false;\n    data.hash = error.message;\n  }\n};\nconst empowerFn = async () => {\n  if (data.check) {\n    return;\n  }\n  data.empowerText = 'EmpowerAlert.btn1';\n  data.check = true;\n  try {\n    const res = await swap_store.tokenMethods\n      .approve(swap_store.marketSpender, MaxUint256)\n      .send({ from: common_store.address });\n    swap_store.setMarketEmpower();\n    data.check = false;\n    data.empowerText = 'EmpowerAlert.btn4';\n  } catch (error) {\n    data.check = false;\n    data.empowerText = 'EmpowerAlert.btn4';\n    window.$messag(error.message);\n  }\n};\nconst closeFn = () => {\n  data.alertShow = false;\n  if (data.success) {\n    setTimeout(() => {\n      router.go(-1);\n    }, 1000);\n  }\n};\n</script>\n<template>\n  <div class=\"cen market-details\">\n    <div class=\"allFlex\">\n      <div class=\"info-img\">\n        <img :src=\"getUrl(info.tokenid)\" alt=\"\" class=\"\" />\n      </div>\n      <ul class=\"info-data allFlex column\">\n        <li class=\"Wcolor font-Three font500\">{{ $t('titleText') }}</li>\n        <li class=\"mainColor font-Tf Bold details_title\">\n          {{ $t('name') }}#{{ info.tokenid }}\n        </li>\n        <li class=\"font-Six Wcolor details_text\">\n          {{ $t('Market.seller') }}\n          <span class=\"lightGrey font-Three marginTen\">{{ info.seller }}</span>\n        </li>\n        <li>\n          <buy-info :info=\"info\" :colorId=\"colorId\" @buy=\"toBuy\"></buy-info>\n        </li>\n      </ul>\n    </div>\n\n    <div class=\"record\">\n      <p class=\"Wcolor font-Tt Bold record_title\">{{ $t('Market.record') }}</p>\n      <n-data-table :columns=\"columns\" :data=\"data.list\" />\n      <n-pagination\n        v-model:page=\"data.page\"\n        page-size=\"20\"\n        :item-count=\"data.total\"\n        class=\"pagination\"\n      />\n    </div>\n    <n-modal v-model:show=\"data.alertShow\">\n      <swap-alert\n        :finish=\"data.finish\"\n        :success=\"data.success\"\n        :hash=\"data.hash\"\n        :check=\"data.check\"\n        title=\"SwapAlert.title5\"\n        text=\"SwapAlert.success3\"\n        btn=\"buy\"\n        :empower=\"true\"\n        :empowerText=\"data.empowerText\"\n        @closeFn=\"closeFn\"\n        @empowerFn=\"empowerFn\"\n        @submit=\"buyFn\"\n      >\n        <p class=\"font-Four\">\n          {{\n            $t('Home.text12', {\n              start: common_store.address.slice(0, 6),\n              end: common_store.address.slice(-4),\n            })\n          }}\n        </p>\n      </swap-alert>\n    </n-modal>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.market-details {\n  padding: 25px 0;\n}\n.info-img {\n  width: 52%;\n  border-radius: 10px;\n  font-size: 0;\n  overflow: hidden;\n  img {\n    width: 100%;\n  }\n}\n.info-data {\n  width: 45%;\n  height: 100%;\n}\n.details_title {\n  height: 60px;\n  line-height: 60px;\n}\n.details_text {\n  height: 22px;\n  line-height: 22px;\n  margin-top: 25px;\n}\n.record {\n  margin-top: 20px;\n  &_title {\n    height: 60px;\n    line-height: 60px;\n  }\n}\n.list-slot {\n  height: 40px;\n}\n.pagination {\n  margin-top: 20px;\n}\n</style>\n","import script from \"./details.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./details.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./details.vue?vue&type=style&index=0&id=39e20c8a&lang=scss&scoped=true\"\n\nimport exportComponent from \"/Users/zhuweiyun/Desktop/zwy/vue3-pc-天空之城/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-39e20c8a\"]])\n\nexport default __exports__"],"names":["__exports__","hash","toRefs","props","toClipboard","commonStore","useClipboard","swap_store","swapStore","common_store","info","console","log","value","data","reactive","x","y","check","empowerText","onBeforeMount","getXY","id","empowerFn","async","tokenMethods","approve","marketSpender","MaxUint256","send","from","address","setMarketEmpower","error","window","$messag","message","route","useRoute","router","useRouter","t","useI18n","query","colorId","ref","list","alertShow","finish","success","loading","finished","page","show","total","tokenBal","columns","title","render","row","Number","balanceUtil","price","toFixed","key","getFullTime","selltime","getPixelColor","res","allMethods","getPixel","tokenid","call","color","getRecordList","getPixelRecord","then","results","count","getTokenBal","getTokenMethods","balanceOf","watchEffect","toBuy","$message","warning","seller","buyFn","marketMethods","buy","transactionHash","addHash","closeFn","setTimeout","go"],"sourceRoot":""}